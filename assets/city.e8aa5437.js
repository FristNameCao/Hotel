import{c as U,d as X,q as A,aB as lt,W as rt,b as O,x as ut,s as j,C as dt,k as q,a as y,F as ht,t as pt,n as Y,O as ft,aC as _t,a8 as P,a4 as G,A as vt,ar as mt,aq as K,p as yt,R as gt,S as xt,e as kt,v as bt,aD as Ct,w as W,a9 as Z,ak as J,ac as m,am as L,aE as Q,ae as w,ad as b,G as I,al as $,af as St,ag as D,ab as Tt,y as It,z as At,ah as wt,ai as Rt}from"./index.4bbdb7fe.js";import{T as $t,a as Ot}from"./index.9c0bfe85.js";import{u as tt,C as Bt,S as Et}from"./city.63504632.js";import{u as Nt,a as et}from"./index.997e9c32.js";function Pt(){const t="A".charCodeAt(0);return Array(26).fill("").map((o,h)=>String.fromCharCode(t+h))}const[ot,N]=U("index-bar"),Gt={sticky:pt,zIndex:Y,teleport:[String,Object],highlightColor:String,stickyOffsetTop:ft(0),indexList:{type:Array,default:Pt}},nt=Symbol(ot);var Lt=X({name:ot,props:Gt,emits:["select","change"],setup(t,{emit:d,slots:o}){const h=A(),l=A(),p=A(""),s=Nt(),f=lt(h),{children:n,linkChildren:g}=rt(nt);let a;g({props:t});const x=O(()=>{if(ut(t.zIndex))return{zIndex:+t.zIndex+1}}),r=O(()=>{if(t.highlightColor)return{color:t.highlightColor}}),_=(e,c)=>{for(let i=n.length-1;i>=0;i--){const v=i>0?c[i-1].height:0,u=t.sticky?v+t.stickyOffsetTop:0;if(e+u>=c[i].top)return i}return-1},B=e=>n.find(c=>String(c.index)===e),E=()=>{if(_t(h))return;const{sticky:e,indexList:c}=t,i=P(f.value),v=G(f),u=n.map(T=>T.getRect(f.value,v));let C=-1;if(a){const T=B(a);if(T){const S=T.getRect(f.value,v);C=_(S.top,u)}}else C=_(i,u);p.value=c[C],e&&n.forEach((T,S)=>{const{state:k,$el:it}=T;if(S===C||S===C-1){const R=it.getBoundingClientRect();k.left=R.left,k.width=R.width}else k.left=null,k.width=null;if(S===C)k.active=!0,k.top=Math.max(t.stickyOffsetTop,u[S].top-i)+v.top;else if(S===C-1&&a===""){const R=u[C].top-i;k.active=R>0,k.top=R+v.top-u[S].height}else k.active=!1}),a=""},V=()=>{vt(E)};j("scroll",E,{target:f,passive:!0}),dt(V),q(()=>t.indexList,V),q(p,e=>{e&&d("change",e)});const ct=()=>t.indexList.map(e=>{const c=e===p.value;return y("span",{class:N("index",{active:c}),style:c?r.value:void 0,"data-index":e},[e])}),z=e=>{a=String(e);const c=B(a);if(c){const i=P(f.value),v=G(f),{offsetHeight:u}=document.documentElement;if(c.$el.scrollIntoView(),i===u-v.height){E();return}t.sticky&&t.stickyOffsetTop&&mt(K()-t.stickyOffsetTop),d("select",c.index)}},M=e=>{const{index:c}=e.dataset;c&&z(c)},st=e=>{M(e.target)};let F;const at=e=>{if(s.move(e),s.isVertical()){yt(e);const{clientX:c,clientY:i}=e.touches[0],v=document.elementFromPoint(c,i);if(v){const{index:u}=v.dataset;u&&F!==u&&(F=u,M(v))}}},H=()=>y("div",{ref:l,class:N("sidebar"),style:x.value,onClick:st,onTouchstartPassive:s.start},[ct()]);return et({scrollTo:z}),j("touchmove",at,{target:l}),()=>{var e;return y("div",{ref:h,class:N()},[t.teleport?y(ht,{to:t.teleport},{default:()=>[H()]}):H(),(e=o.default)==null?void 0:e.call(o)])}}});const[Dt,Vt]=U("index-anchor"),zt={index:Y};var Mt=X({name:Dt,props:zt,setup(t,{slots:d}){const o=gt({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),h=A(),{parent:l}=xt(nt);if(!l)return;const p=()=>o.active&&l.props.sticky,s=O(()=>{const{zIndex:n,highlightColor:g}=l.props;if(p())return kt(bt(n),{left:o.left?`${o.left}px`:void 0,width:o.width?`${o.width}px`:void 0,transform:o.top?`translate3d(0, ${o.top}px, 0)`:void 0,color:g})});return et({state:o,getRect:(n,g)=>{const a=G(h);return o.rect.height=a.height,n===window||n===document.body?o.rect.top=a.top+K():o.rect.top=a.top+P(n)-g.top,o.rect}}),()=>{const n=p();return y("div",{ref:h,style:{height:n?`${o.rect.height}px`:void 0}},[y("div",{style:s.value,class:[Vt({sticky:n}),{[Ct]:n}]},[d.default?d.default():t.index])])}}});const Ft=W(Mt),Ht=W(Lt);const jt={class:"list"},qt=["onClick"],Ut={__name:"city-group-item",props:{cityGroup:{type:Object,default:()=>({})}},setup(t){const d=t,o=O(()=>{const s=d.cityGroup.cities.map(f=>f.group);return s.unshift("#"),s}),h=J(),l=tt(),p=s=>{l.currentStore.cityName=s,h.back()};return(s,f)=>{const n=Ft,g=Bt,a=Ht;return m(),L(a,{"index-list":D(o)},{default:Q(()=>[y(n,{index:"\u70ED\u95E8"}),w("div",jt,[(m(!0),b(I,null,$(d.cityGroup.hotCities,(x,r)=>(m(),b("div",{key:r,class:"city",onClick:_=>p(x.cityName)},St(x.cityName),9,qt))),128))]),(m(!0),b(I,null,$(d.cityGroup.cities,(x,r)=>(m(),b(I,{key:r},[w("div",null,[y(n,{index:x.group},null,8,["index"])]),(m(!0),b(I,null,$(x.cities,(_,B)=>(m(),b("div",{key:B},[y(g,{title:_.cityName,onClick:E=>p(_.cityName)},null,8,["title","onClick"])]))),128))],64))),128))]),_:1},8,["index-list"])}}},Xt=Z(Ut,[["__scopeId","data-v-bcda2585"]]);const Yt=t=>(wt("data-v-bf69b198"),t=t(),Rt(),t),Kt={class:"city"},Wt={class:"top"},Zt=Yt(()=>w("h2",null,"city",-1)),Jt={action:"/"},Qt={class:"content"},te={__name:"city",setup(t){const d=J();O(()=>s.value[l.value]);const o=A(""),h=()=>{d.back()},l=A(),p=tt();p.fetchAllCitiesData();const{allCities:s}=Tt(p);return(f,n)=>{const g=Et,a=$t,x=Ot;return m(),b("div",Kt,[w("div",Wt,[Zt,w("form",Jt,[y(g,{modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=r=>o.value=r),placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u5173\u952E\u8BCD","show-action":"",onCancel:h},null,8,["modelValue"])]),y(x,{active:l.value,"onUpdate:active":n[1]||(n[1]=r=>l.value=r),color:"#ff9854"},{default:Q(()=>[(m(!0),b(I,null,$(D(s),(r,_)=>(m(),L(a,{key:_,title:r.title,name:_},null,8,["title","name"]))),128))]),_:1},8,["active"])]),w("div",Qt,[(m(!0),b(I,null,$(D(s),(r,_)=>It((m(),L(Xt,{key:_,cityGroup:r},null,8,["cityGroup"])),[[At,l.value===_]])),128))])])}}},se=Z(te,[["__scopeId","data-v-bf69b198"]]);export{se as default};
